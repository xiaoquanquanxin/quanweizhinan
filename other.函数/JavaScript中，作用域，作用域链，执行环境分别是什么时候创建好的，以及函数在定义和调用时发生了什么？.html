<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta http-equiv='x-ua-compatible' content="IE=edge">
    <title>JavaScript中，作用域，作用域链，执行环境分别是什么时候创建好的，以及函数在定义和调用时发生了什么？</title>
    <style>
        body{
            text-align: justify;
        }
    </style>
</head>
<body>
<h3>执行环境</h3>
<p>当前执行环境就是当前的代码的上下文,执行环境定义了变量的访问权限,也保存了上一级执行环境的引用.</p>
<p>每一个执行环境都对应一个变量对象,变量对象中保存了在当前执行环境下有权访问的变量的值的引用.</p>
<h3>函数</h3>
<p>函数是一个对象,在这个对象的[内部属性]里保存了参数,函数体代码,当前的执行环境,三个部分.</p>
<p>这个[内部属性]是无法改变的.</p>
<h3>定义函数</h3>
<p>定义函数,就是让函数绑[内部属性].</p>
<p>在执行到定义函数之前,这个函数是不存在的.</p>
<h3>调用函数</h3>
<p>创建函数体的执行环境,并将其当做当前的执行环境,函数绑定的执行环境当做上一级执行环境.</p>
<h3>作用域链</h3>
<p>当前执行环境与上一级执行环境分别对应的变量对象会创建一条链,作用域链.</p>
<p>标识符的检索是根据作用域链一级一级向上检索.</p>
<h3>小结</h3>
<h5>已知</h5>
<p>1.由于执行环境是函数的[内部属性],无法被改变.</p>
<p>2.函数调用的时候会依赖执行环境创建作用域链.</p>
<p>3.标识符的检索根据作用域链一级一级向上检索.</p>
<p>那就是为什么函数的执行与当前作用域无关,而与函数定义时绑定的作用域有关.</p>
<h3>闭包</h3>
<p>拥有多个变量和绑定了这些变量的环境的表达式,通常是一个函数,这些变量也是该表达式的一部分。</p>
<p>在一个函数中定义另一个函数,在调用内部函数时,由于执行环境的嵌套关系,形成的作用域链会包含外部函数的变量对象.</p>
<p>所以无论在哪里调用内部函数,都可以访问外部函数中定义的变量或参数.</p>
<p>通常,函数执行完以后,垃圾回收机制会释放局部变量引用对象的内存.但由于闭包函数的作用域链中保留了对这些变量的引用,所以不会释放这些内存.</p>
</body>
</html>